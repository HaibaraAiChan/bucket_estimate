main start at this time 1683316463.4833434
-----------------------------------------before load data 
 Nvidia-smi: 2.84765625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 2.84765625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

173
221
374
456
445
550
655
512
576
640
624
583
615
695
673
614
556
604
584
572
586
592
648
645
183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

before  shuffle  tensor([     0,      1,      2,  ..., 196568, 196569, 196570])
after shuffle  tensor([     0,      1,      2,  ..., 196568, 196569, 196570])

























 the number of batches:  25
check_connections_block*********************************
num of batch  25
check_connections_block*********************************
----------------------------------------after generate_dataloader_bucket_block 
 Nvidia-smi: 4.025390625 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

batch 0
src global  484786
seeds global  13193
----------------------------------------after load_block_subtensor
 Nvidia-smi: 4.20703125 GB
    Memory Allocated: 0.18163061141967773  GigaBytes
Max Memory Allocated: 0.18163061141967773  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 4.31640625 GB
    Memory Allocated: 0.19082117080688477  GigaBytes
Max Memory Allocated: 0.19082117080688477  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  24
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
----------------------------------------after model forward
 Nvidia-smi: 12.068359375 GB
    Memory Allocated: 7.73599910736084  GigaBytes
Max Memory Allocated: 7.829929351806641  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 12.068359375 GB
    Memory Allocated: 7.73831033706665  GigaBytes
Max Memory Allocated: 7.829929351806641  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 12.333984375 GB
    Memory Allocated: 0.20547151565551758  GigaBytes
Max Memory Allocated: 7.829929351806641  GigaBytes

---------------------------------------- batch 0
 Nvidia-smi: 12.333984375 GB
    Memory Allocated: 0.20547151565551758  GigaBytes
Max Memory Allocated: 7.829929351806641  GigaBytes

batch 1
src global  763262
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 12.333984375 GB
    Memory Allocated: 0.29304981231689453  GigaBytes
Max Memory Allocated: 7.829929351806641  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 12.333984375 GB
    Memory Allocated: 0.3069005012512207  GigaBytes
Max Memory Allocated: 7.829929351806641  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 11.341034412384033  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 11.34285593032837  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.32272863388061523  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

---------------------------------------- batch 1
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.32272863388061523  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

batch 2
src global  759079
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.2958526611328125  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.30947399139404297  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 11.28347396850586  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 11.2851243019104  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.32567644119262695  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

---------------------------------------- batch 2
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.32567644119262695  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

batch 3
src global  760300
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.3011207580566406  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 20.94140625 GB
    Memory Allocated: 0.31477832794189453  GigaBytes
Max Memory Allocated: 11.522630214691162  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.344422817230225  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.34660291671753  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.33098697662353516  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

---------------------------------------- batch 3
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.33098697662353516  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

batch 4
src global  763330
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.30703115463256836  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.32068490982055664  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.321331977844238  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.322670459747314  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.33684873580932617  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

---------------------------------------- batch 4
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.33684873580932617  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

batch 5
src global  762369
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3114137649536133  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3250846862792969  GigaBytes
Max Memory Allocated: 11.524697303771973  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.355616569519043  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.35695505142212  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3417477607727051  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

---------------------------------------- batch 5
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3417477607727051  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

batch 6
src global  762431
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.31665897369384766  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3303089141845703  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.327146053314209  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.328704357147217  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.34652233123779297  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

---------------------------------------- batch 6
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.34652233123779297  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

batch 7
src global  764615
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3222670555114746  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3359551429748535  GigaBytes
Max Memory Allocated: 11.536350727081299  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.37406587600708  GigaBytes
Max Memory Allocated: 11.555215835571289  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.376113414764404  GigaBytes
Max Memory Allocated: 11.555215835571289  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3522214889526367  GigaBytes
Max Memory Allocated: 11.555215835571289  GigaBytes

---------------------------------------- batch 7
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3522214889526367  GigaBytes
Max Memory Allocated: 11.555215835571289  GigaBytes

batch 8
src global  766319
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.32770872116088867  GigaBytes
Max Memory Allocated: 11.555215835571289  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3413996696472168  GigaBytes
Max Memory Allocated: 11.555215835571289  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.3791823387146  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.380590438842773  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3577113151550293  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

---------------------------------------- batch 8
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3577113151550293  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

batch 9
src global  763198
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.33139562606811523  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3450503349304199  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.372202396392822  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.373540878295898  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.361391544342041  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

---------------------------------------- batch 9
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.361391544342041  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

batch 10
src global  763048
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3362569808959961  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.35042762756347656  GigaBytes
Max Memory Allocated: 11.56020975112915  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.386839389801025  GigaBytes
Max Memory Allocated: 11.566540241241455  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.388177871704102  GigaBytes
Max Memory Allocated: 11.566540241241455  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.36729907989501953  GigaBytes
Max Memory Allocated: 11.566540241241455  GigaBytes

---------------------------------------- batch 10
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.36729907989501953  GigaBytes
Max Memory Allocated: 11.566540241241455  GigaBytes

batch 11
src global  762412
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.34145021438598633  GigaBytes
Max Memory Allocated: 11.566540241241455  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3551182746887207  GigaBytes
Max Memory Allocated: 11.566540241241455  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.389118671417236  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.391302585601807  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3716554641723633  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

---------------------------------------- batch 11
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3716554641723633  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

batch 12
src global  759982
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3456435203552246  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.35928869247436523  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.352875232696533  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.355181217193604  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.37535953521728516  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

---------------------------------------- batch 12
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.37535953521728516  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

batch 13
src global  765887
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.35250043869018555  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3661932945251465  GigaBytes
Max Memory Allocated: 11.569975852966309  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.408237934112549  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.409961223602295  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.38220930099487305  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

---------------------------------------- batch 13
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.38220930099487305  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

batch 14
src global  763515
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.356168270111084  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3698611259460449  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.402019023895264  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.403422355651855  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3868846893310547  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

---------------------------------------- batch 14
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3868846893310547  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

batch 15
src global  763895
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.36189699172973633  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.37554311752319336  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.370211124420166  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.372284412384033  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.39148902893066406  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

---------------------------------------- batch 15
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.39148902893066406  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

batch 16
src global  760163
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3650374412536621  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.37867212295532227  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.364789485931396  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.366249084472656  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.39476442337036133  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

---------------------------------------- batch 16
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.39476442337036133  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

batch 17
src global  765826
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.37183618545532227  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3855166435241699  GigaBytes
Max Memory Allocated: 11.589025497436523  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.416346549987793  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.418273448944092  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4018425941467285  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

---------------------------------------- batch 17
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4018425941467285  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

batch 18
src global  762212
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3753647804260254  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.38904523849487305  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.3889741897583  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.390389919281006  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4053053855895996  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

---------------------------------------- batch 18
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4053053855895996  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

batch 19
src global  762675
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.38037681579589844  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.3940258026123047  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.392677307128906  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.394015789031982  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4112734794616699  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

---------------------------------------- batch 19
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4112734794616699  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

batch 20
src global  765350
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.38720273971557617  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4008755683898926  GigaBytes
Max Memory Allocated: 11.596697330474854  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.436800003051758  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.438724517822266  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4164104461669922  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

---------------------------------------- batch 20
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4164104461669922  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

batch 21
src global  761763
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.38995790481567383  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.40363073348999023  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.407501697540283  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.40892505645752  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4206705093383789  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

---------------------------------------- batch 21
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4206705093383789  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

batch 22
src global  758708
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.39443206787109375  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4080667495727539  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.394101619720459  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.395568370819092  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4236288070678711  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

---------------------------------------- batch 22
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.4236288070678711  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

batch 23
src global  762638
seeds global  7641
----------------------------------------after load_block_subtensor
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.400054931640625  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.41370296478271484  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  1
[25]
----------------------------------------after model forward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.41172742843628  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 11.41401720046997  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.43029022216796875  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

---------------------------------------- batch 23
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.43029022216796875  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.40709447860717773  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 5.0051469802856445
---------------------------------------- batch 24 after optimizer
 Nvidia-smi: 21.544921875 GB
    Memory Allocated: 0.40709447860717773  GigaBytes
Max Memory Allocated: 11.618665218353271  GigaBytes


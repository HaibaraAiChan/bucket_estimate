main start at this time 1685742423.5373633
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

len(bkt)  173
len(bkt)  221
len(bkt)  374
len(bkt)  456
len(bkt)  445
len(bkt)  550
len(bkt)  655
len(bkt)  512
len(bkt)  576
len(bkt)  640
len(bkt)  624
len(bkt)  583
len(bkt)  615
len(bkt)  695
len(bkt)  673
len(bkt)  614
len(bkt)  556
len(bkt)  604
len(bkt)  584
len(bkt)  572
len(bkt)  586
len(bkt)  592
len(bkt)  648
len(bkt)  645
len(bkt)  183378
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--

 the number of batches:  19
the ratio of the output nids to be processed:  0.9328843013465873
weights list of these nids:  [0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04910185123950125, 0.04905097903556476]
check_connections_block*********************************
num of batch  19
check_connections_block*********************************
generate_K_hop_neighbors time  59.15366983413696
8.489265868274341
8.510481041963493
8.504128589765696
8.476853378344995
8.477488623564774
8.475260223666817
8.495940984710758
8.503967257646387
8.46694153626494
8.493319337771984
8.520201302151868
8.49355125269349
8.455577705111104
8.476500464334006
8.514605094263333
8.460800832473737
8.492926090731167
8.539097326625951
8.480265020583609
the split redundant ratio 
[8.489265868274341, 8.510481041963493, 8.504128589765696, 8.476853378344995, 8.477488623564774, 8.475260223666817, 8.495940984710758, 8.503967257646387, 8.46694153626494, 8.493319337771984, 8.520201302151868, 8.49355125269349, 8.455577705111104, 8.476500464334006, 8.514605094263333, 8.460800832473737, 8.492926090731167, 8.539097326625951, 8.480265020583609]
19
average memory estimation for each split fanout bucket batch 13.786546410165027
capacity est:  0.1352024986099689
capacity  393
sorted_dict  {23: 393, 22: 386, 21: 357, 20: 325, 18: 297, 19: 291, 17: 277, 16: 261, 15: 251, 14: 245, 13: 236, 12: 210, 10: 178, 11: 175, 9: 159, 8: 130, 7: 109, 6: 102, 5: 78, 4: 54, 3: 40, 2: 24, 1: 10, 0: 4}

weights after sort [393, 386, 357, 325, 297, 291, 277, 261, 251, 245, 236, 210, 178, 175, 159, 130, 109, 102, 78, 54, 40, 24, 10, 4]

remove bucket_id:  [0]
original bucket_id :,  [23]
remove weights:  [393], 		------------sum 393

before remove weights,  [393, 386, 357, 325, 297, 291, 277, 261, 251, 245, 236, 210, 178, 175, 159, 130, 109, 102, 78, 54, 40, 24, 10, 4]
after remove pre pack weights,  [386, 357, 325, 297, 291, 277, 261, 251, 245, 236, 210, 178, 175, 159, 130, 109, 102, 78, 54, 40, 24, 10, 4]

remove bucket_id:  [4, 16]
original bucket_id :,  [19, 6]
remove weights:  [291 102], 		------------sum 393

before remove weights,  [386, 357, 325, 297, 291, 277, 261, 251, 245, 236, 210, 178, 175, 159, 130, 109, 102, 78, 54, 40, 24, 10, 4]
after remove pre pack weights,  [386, 357, 325, 297, 277, 261, 251, 245, 236, 210, 178, 175, 159, 130, 109, 78, 54, 40, 24, 10, 4]

remove bucket_id:  [5, 15, 16]
original bucket_id :,  [16, 5, 4]
remove weights:  [261  78  54], 		------------sum 393

before remove weights,  [386, 357, 325, 297, 277, 261, 251, 245, 236, 210, 178, 175, 159, 130, 109, 78, 54, 40, 24, 10, 4]
after remove pre pack weights,  [386, 357, 325, 297, 277, 251, 245, 236, 210, 178, 175, 159, 130, 109, 40, 24, 10, 4]

remove bucket_id:  [9, 10, 14]
original bucket_id :,  [10, 11, 3]
remove weights:  [178 175  40], 		------------sum 393

before remove weights,  [386, 357, 325, 297, 277, 251, 245, 236, 210, 178, 175, 159, 130, 109, 40, 24, 10, 4]
after remove pre pack weights,  [386, 357, 325, 297, 277, 251, 245, 236, 210, 159, 130, 109, 24, 10, 4]

remove bucket_id:  [8, 9, 12]
original bucket_id :,  [12, 9, 2]
remove weights:  [210 159  24], 		------------sum 393

before remove weights,  [386, 357, 325, 297, 277, 251, 245, 236, 210, 159, 130, 109, 24, 10, 4]
after remove pre pack weights,  [386, 357, 325, 297, 277, 251, 245, 236, 130, 109, 10, 4]

remove bucket_id:  [5, 8, 10]
original bucket_id :,  [15, 8, 1]
remove weights:  [251 130  10], 		------------sum 391

before remove weights,  [386, 357, 325, 297, 277, 251, 245, 236, 130, 109, 10, 4]
after remove pre pack weights,  [386, 357, 325, 297, 277, 245, 236, 109, 4]

remove bucket_id:  [0, 8]
original bucket_id :,  [22, 0]
remove weights:  [386   4], 		------------sum 390

before remove weights,  [386, 357, 325, 297, 277, 245, 236, 109, 4]
after remove pre pack weights,  [357, 325, 297, 277, 245, 236, 109]

remove bucket_id:  [3, 6]
original bucket_id :,  [17, 7]
remove weights:  [277 109], 		------------sum 386

before remove weights,  [357, 325, 297, 277, 245, 236, 109]
after remove pre pack weights,  [357, 325, 297, 245, 236]

remove bucket_id:  [0]
original bucket_id :,  [21]
remove weights:  [357], 		------------sum 357

before remove weights,  [357, 325, 297, 245, 236]
after remove pre pack weights,  [325, 297, 245, 236]

remove bucket_id:  [0]
original bucket_id :,  [20]
remove weights:  [325], 		------------sum 325

before remove weights,  [325, 297, 245, 236]
after remove pre pack weights,  [297, 245, 236]

remove bucket_id:  [0]
original bucket_id :,  [18]
remove weights:  [297], 		------------sum 297

before remove weights,  [297, 245, 236]
after remove pre pack weights,  [245, 236]

remove bucket_id:  [0]
original bucket_id :,  [14]
remove weights:  [245], 		------------sum 245

before remove weights,  [245, 236]
after remove pre pack weights,  [236]
the last batch value is  236
G_BUCKET_ID_list [[23], [19, 6], [16, 5, 4], [10, 11, 3], [12, 9, 2], [15, 8, 1], [22, 0], [17, 7], [21], [20], [18], [14], [13]]
G_BUCKET_ID_list length 13
split_batches_nid_list  19
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[23]
23
current group_mem  0.3936424255371094
the new estimated memory cost(GB) for batch 0 14.180188835702136
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[19, 6]
19
6
current group_mem  0.3939943313598633
the new estimated memory cost(GB) for batch 1 14.18054074152489
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[16, 5, 4]
16
5
4
current group_mem  0.39342212677001953
the new estimated memory cost(GB) for batch 2 14.179968536935046
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[10, 11, 3]
10
11
3
current group_mem  0.3951072692871094
the new estimated memory cost(GB) for batch 3 14.181653679452136
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[12, 9, 2]
12
9
2
current group_mem  0.3951902389526367
the new estimated memory cost(GB) for batch 4 14.181736649117664
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[15, 8, 1]
15
8
1
current group_mem  0.3924407958984375
the new estimated memory cost(GB) for batch 5 14.178987206063464
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[22, 0]
22
0
current group_mem  0.3905782699584961
the new estimated memory cost(GB) for batch 6 14.177124680123523
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[17, 7]
17
7
current group_mem  0.38684749603271484
the new estimated memory cost(GB) for batch 7 14.173393906197742
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[21]
21
current group_mem  0.3578939437866211
the new estimated memory cost(GB) for batch 8 14.144440353951648
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[20]
20
current group_mem  0.3255643844604492
the new estimated memory cost(GB) for batch 9 14.112110794625476
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[18]
18
current group_mem  0.29793834686279297
the new estimated memory cost(GB) for batch 10 14.08448475702782
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[14]
14
current group_mem  0.24538421630859375
the new estimated memory cost(GB) for batch 11 14.03193062647362
[0.004248619079589844, 0.010951995849609375, 0.024433135986328125, 0.040657997131347656, 0.054093360900878906, 0.0782003402709961, 0.10260200500488281, 0.1095743179321289, 0.1300048828125, 0.1599140167236328, 0.17887401580810547, 0.17557525634765625, 0.21084308624267578, 0.23604297637939453, 0.24538421630859375, 0.2514839172363281, 0.26112842559814453, 0.27727317810058594, 0.29793834686279297, 0.29139232635498047, 0.3255643844604492, 0.3578939437866211, 0.38632965087890625, 0.3936424255371094]
[13]
13
current group_mem  0.23604297637939453
the new estimated memory cost(GB) for batch 12 14.022589386544421
the length of split_batches_nid_list  19
len local_batched_seeds_list  19
 the number of batches:  19
check_connections_block*********************************
num of batch  19
check_connections_block*********************************
----------------------------------------after generate_dataloader_bucket_block 
 Nvidia-smi: 1.34375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

batch 0
src global  871908
seeds global  10300
----------------------------------------after load_block_subtensor
 Nvidia-smi: 1.669921875 GB
    Memory Allocated: 0.3258228302001953  GigaBytes
Max Memory Allocated: 0.3258228302001953  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 1.779296875 GB
    Memory Allocated: 0.3432273864746094  GigaBytes
Max Memory Allocated: 0.3432273864746094  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 16.228515625 GB
    Memory Allocated: 14.41001844406128  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 16.228515625 GB
    Memory Allocated: 14.412701606750488  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 16.236328125 GB
    Memory Allocated: 0.3672618865966797  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

---------------------------------------- batch 0
 Nvidia-smi: 16.236328125 GB
    Memory Allocated: 0.3672618865966797  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

batch 1
src global  871214
seeds global  10786
----------------------------------------after load_block_subtensor
 Nvidia-smi: 16.236328125 GB
    Memory Allocated: 0.3352341651916504  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 16.236328125 GB
    Memory Allocated: 0.3527646064758301  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 17.01171875 GB
    Memory Allocated: 14.398340225219727  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 17.01171875 GB
    Memory Allocated: 14.400927543640137  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 17.01171875 GB
    Memory Allocated: 0.37407636642456055  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

---------------------------------------- batch 1
 Nvidia-smi: 17.01171875 GB
    Memory Allocated: 0.37407636642456055  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

batch 2
src global  870400
seeds global  11167
----------------------------------------after load_block_subtensor
 Nvidia-smi: 17.01171875 GB
    Memory Allocated: 0.34187889099121094  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 17.01171875 GB
    Memory Allocated: 0.359405517578125  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 14.350272178649902  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 14.352859497070312  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.3798680305480957  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

---------------------------------------- batch 2
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.3798680305480957  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

batch 3
src global  873180
seeds global  11290
----------------------------------------after load_block_subtensor
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.34887266159057617  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.36640310287475586  GigaBytes
Max Memory Allocated: 14.642583847045898  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 14.41858720779419  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 14.420602798461914  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.38727283477783203  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

---------------------------------------- batch 3
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.38727283477783203  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

batch 4
src global  869828
seeds global  11032
----------------------------------------after load_block_subtensor
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.3541269302368164  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.3716440200805664  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 14.326188564300537  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 14.328166007995605  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.39266109466552734  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

---------------------------------------- batch 4
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.39266109466552734  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

batch 5
src global   879487
seeds global  11010
----------------------------------------after load_block_subtensor
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.36423206329345703  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 17.033203125 GB
    Memory Allocated: 0.3817625045776367  GigaBytes
Max Memory Allocated: 14.652612686157227  GigaBytes

----------------------------------------after model forward
 Nvidia-smi: 17.841796875 GB
    Memory Allocated: 14.47924280166626  GigaBytes
Max Memory Allocated: 14.713595867156982  GigaBytes

----------------------------------------after loss_fcn calculation
 Nvidia-smi: 17.841796875 GB
    Memory Allocated: 14.481171131134033  GigaBytes
Max Memory Allocated: 14.713595867156982  GigaBytes

----------------------------------------after loss backward
 Nvidia-smi: 17.841796875 GB
    Memory Allocated: 0.4030637741088867  GigaBytes
Max Memory Allocated: 14.713595867156982  GigaBytes

---------------------------------------- batch 5
 Nvidia-smi: 17.841796875 GB
    Memory Allocated: 0.4030637741088867  GigaBytes
Max Memory Allocated: 14.713595867156982  GigaBytes

batch 6
src global   1813942
seeds global  183970
----------------------------------------after load_block_subtensor
 Nvidia-smi: 17.841796875 GB
    Memory Allocated: 0.7205090522766113  GigaBytes
Max Memory Allocated: 14.713595867156982  GigaBytes

----------------------------------------after blocks to device
 Nvidia-smi: 17.841796875 GB
    Memory Allocated: 0.8405318260192871  GigaBytes
Max Memory Allocated: 14.713595867156982  GigaBytes

File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/cc/.local/lib/python3.6/site-packages/torch/nn/modules/rnn.py", line 680, in forward
    self.dropout, self.training, self.bidirectional, self.batch_first)
RuntimeError: CUDA out of memory. Tried to allocate 1.65 GiB (GPU 0; 23.65 GiB total capacity; 20.31 GiB already allocated; 1.23 GiB free; 20.90 GiB reserved in total by PyTorch)